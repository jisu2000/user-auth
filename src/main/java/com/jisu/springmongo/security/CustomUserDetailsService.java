package com.jisu.springmongo.security;import com.jisu.springmongo.constants.AppConstants;import com.jisu.springmongo.model.UserEO;import com.jisu.springmongo.repo.UserRepo;import lombok.RequiredArgsConstructor;import org.springframework.security.core.userdetails.UserDetails;import org.springframework.security.core.userdetails.UserDetailsService;import org.springframework.security.core.userdetails.UsernameNotFoundException;import org.springframework.stereotype.Service;import java.util.regex.Matcher;import java.util.regex.Pattern;@Service@RequiredArgsConstructorpublic class CustomUserDetailsService implements UserDetailsService {    private final UserRepo userRepo;    @Override    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {        UserEO userEO = null;        final Pattern EMAIL_PATTERN = Pattern.compile(AppConstants.EMAIL_REGEX);        Matcher matcher = EMAIL_PATTERN.matcher(username);        if (matcher.matches()) {            userEO = userRepo.findByEmail(username);        } else {            userEO = userRepo.findByMobileNumber(username);        }        if (userEO == null) {            throw new UsernameNotFoundException("User not found");        }        return SecurityUser.builder()                .userEO(userEO)                .build();    }}