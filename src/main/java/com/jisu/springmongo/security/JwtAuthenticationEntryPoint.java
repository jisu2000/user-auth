package com.jisu.springmongo.security;import com.fasterxml.jackson.databind.ObjectMapper;import jakarta.servlet.ServletException;import jakarta.servlet.http.HttpServletRequest;import jakarta.servlet.http.HttpServletResponse;import org.springframework.security.core.AuthenticationException;import org.springframework.security.web.AuthenticationEntryPoint;import org.springframework.stereotype.Component;import java.io.IOException;import java.util.HashMap;import java.util.Map;@Componentpublic class JwtAuthenticationEntryPoint implements AuthenticationEntryPoint {    @Override    public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException) throws IOException, ServletException {        Map<String, String> errorResponse = new HashMap<>();        if (authException != null) {            errorResponse.put("message", "Access Denied!! " + authException.getMessage());        } else {            errorResponse.put("message", "Access Denied!!");        }        ObjectMapper objectMapper = new ObjectMapper();        String jsonResponse = objectMapper.writeValueAsString(errorResponse);        response.setContentType("application/json");        response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);        response.getWriter().write(jsonResponse);        response.getWriter().flush();    }}